{% extends 'base.html' %} {% block content %}
<div class="row shadow-sm p-3 mb-3 background-gradient rounded mx-auto w-75">
  <div class="col">
    <div class="card">
      <div class="card-header">Worldgist Our Home</div>
        <div class="card-body">
          <h5 class="border border-light p-2 text-primary">
            {% block title %} | {{ object.title }} {% endblock title %}</h5>
            <h5 class="card-text background-gradient p-2 rounded-lg">
              <!-- For profile picture -->
                {% if post.author.profile.image %}
                <div class="media">
                  <img
                    src="{{ post.author.profile.image.url }}"
                    alt="Profile-img"
                    class="rounded-circle img-fluid mr-4"
                    id="image-size"
                  />
                {% endif %}
                    <div class="media-body">
                      <code>By:{{ post.author }}</code><br />
                      <small class="text-secondary">{{ post.date_created }}</small>
                    </div>
                </div>
            </h5>
            <hr />
            <div class="text-content">
              <p class="card-text">{{ post.content | linebreaks | urlizetrunc:30 }}</p>
            </div>
          
          <!-- the image section -->
          {% if post.image %}
          <img src="{{ post.image.url }}" alt="Does'nt Exis!" class="img-fluid
          rounded-lg border border-success" />
          {% endif %}
          <!-- the image section ends here -->
          
          <!-- THE SHARE THIS SECTION -->
          <<div class="sharethis-inline-reaction-buttons"></div>
        </div>
      <!-- the below code belongs to comment -->
      {% for comment in post.my_comments.all %}
        {% if user.is_authenticated or comment.approved_comment %}
        <div class="card-body">
          <p class="card-header">
            <h6>{{ comment.added_date }}</h6>
            <h6>Author: {{ comment.author }}</h6>
          </p>
          <p class="card-text">{{ comment.body | linebreaks | urlizetrunc:30 }}</p> <!--safe prevents linebreaks-->
          <!-- the below goes for comment image -->
          {% if comment.comment_img %}
          <img src="{{ comment.comment_img.url }}" alt="Does'nt Exis!" 
          class="img-fluid image-resize rounded-lg border border-success" />
          {% endif %}
          <!-- this section checks to approve comments -->
          {% if not comment.approved_comment %}
            <a href="{% url 'blog:comment-approve' page_id=comment.pk %}">
              <button type="button" class="btn btn-success">Ok</button>
            </a>
            <a href="{% url 'blog:comment-remove' page_id=comment.pk %}">
              <button type="button" class="btn btn-danger">Remove</button>
            </a>
            {% endif %}
            <!-- comments approval ends here --> 
        </div>
        {% endif %}
        {% empty %}
            <h5><i>NO COMMENT YET :(</i></h5>
            <h6>Be the first to comment here</h6>
        {% endfor %}
        {% if user.is_authenticated %}
        <div>
          <a href="{% url 'blog:add-comment-to-post' post.pk %}">
            <button type="submit" class="btn btn-info">Add Comment</button>
          </a>
          <strong>({{ post.my_comments.count }})</strong>
        </div> <br />
        {% else %}
        <div>
          <a href="{% url 'accounts:register' %}">
            <button type="submit" class="btn btn-info">Add Comment</button>
          </a>
          <strong>({{ post.my_comments.count }})</strong>
        </div> <br />
        {% endif %}
        <!-- This section belongs to the like button -->
<div>
  {% if user.is_authenticated %}
  <form action="{% url 'blog:post-likes' pk=post.pk %}" method="POST">
    {% csrf_token %}
    <div class="form-group">
      <input type="hidden" name="like_id" value="{{ post.pk }}" />
    </div>
    {% if user not in post.liked.all %}
      <button type="submit" class="btn btn-success">Like</button>
    {% else %}
      <button type="submit" class="btn btn-danger">Unlike</button>
    {% endif %}
      <strong class="white"><span class="like-count-color">({{ post.liked.count }})
      </span></strong>
  </form>
  {% else %}
  <a href="{% url 'accounts:register' %}">
    <button type="button" class="btn btn-success">Like</button></a>
  <strong class="white"><span class="like-count-color">({{ post.liked.count }})</span>
  </strong>
  {% endif %}
  <!--  -->
  <!-- the end entire end for loop -->
</div>
<!-- like button ends here -->
    </div>
  </div>
</div>

<div class="container mb-5">
  <a href="/"><button type="submit" class="btn btn-primary">Home page</button></a>
</div>
{% block footer %}{% include 'footer.html' %}{% endblock footer %}
<!--  -->
{% endblock content %}

